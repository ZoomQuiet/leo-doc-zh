

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Creating Documents with Leo &mdash; Leo v4.9 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '4.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="Leo v4.9 documentation" href="index.html" />
    <link rel="next" title="Scripting Leo with Python" href="scripting.html" />
    <link rel="prev" title="Controlling Syntax Coloring" href="coloring.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="scripting.html" title="Scripting Leo with Python"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="coloring.html" title="Controlling Syntax Coloring"
             accesskey="P">previous</a> |</li>
        <li><a href="leo_toc.html">Leo v4.9 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="creating-documents-with-leo">
<h1><a class="toc-backref" href="#id1">Creating Documents with Leo</a><a class="headerlink" href="#creating-documents-with-leo" title="Permalink to this headline">¶</a></h1>
<p>This chapter discusses Leo&#8217;s rst3 command. The rst3 command creates HTML, PDF,
LaTeX and other kinds of documents from Leo outlines containing
<a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> (rST) or <a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a> markup.</p>
<p><strong>Note</strong>: <a class="reference external" href="http://docutils.sourceforge.net">docutils</a> is a document processing system using rST markup.
<a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a> extends docutils: Sphinx markup is a superset of rST markup. All of
Leo&#8217;s documentation is written in Sphinx and processed with the rst3 command to
produce HTML files.</p>
<p>Leo and rst3 make writing rST/Sphinx documents a <em>lot</em> easier:</p>
<ol class="arabic simple">
<li>Leo outlines organize writing in all the usual ways. You always see the
structure of your writing clearly no matter how large it is. You can
reorganize chapters, sections and paragraphs effortlessly. View nodes can
show you many different views of your writing simultaneously. These
features, all by themselves, would make Leo an excellent choice for
editing rST documents.</li>
<li>But the rst3 command does more: it automatically creates rST sections from
headlines. Without Leo, changing the level of a section is clumsy and error
prone: you must carefully change the section&#8217;s underlining character. Leo&#8217;s
rst3 command eliminates all this bother.</li>
<li>The rst3 command converts an &#64;rst tree to rST and then sends this text to
docutils or Sphinx for further processing.</li>
</ol>
<p>In addition to these basic features, the rst3 command provides <em>many</em> other
capabilities for power users. We&#8217;ll discuss these features later.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#creating-documents-with-leo" id="id1">Creating Documents with Leo</a><ul>
<li><a class="reference internal" href="#tutorial" id="id2">Tutorial</a><ul>
<li><a class="reference internal" href="#step-1-create-the-rst-node" id="id3">Step 1: Create the &#64;rst node</a><ul>
<li><a class="reference internal" href="#set-global-options" id="id4">Set global options</a></li>
<li><a class="reference internal" href="#set-your-document-s-title" id="id5">Set your document&#8217;s title</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-2-write-your-document" id="id6">Step 2: Write your document</a></li>
<li><a class="reference internal" href="#step-3-run-the-rst3-command" id="id7">Step 3: Run the rst3 command</a></li>
<li><a class="reference internal" href="#go-forth-and-experiment" id="id8">Go forth and experiment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#options" id="id9">Options</a><ul>
<li><a class="reference internal" href="#general-options" id="id10">General options</a></li>
<li><a class="reference internal" href="#headline-commands" id="id11">Headline commands</a></li>
<li><a class="reference internal" href="#option-doc-parts" id="id12">Option doc parts</a></li>
<li><a class="reference internal" href="#defaults-for-options" id="id13">Defaults for options</a></li>
<li><a class="reference internal" href="#http-plugin-options" id="id14">Http plugin options</a></li>
<li><a class="reference internal" href="#section-expansion-options" id="id15">Section expansion options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-topics" id="id16">Other topics</a><ul>
<li><a class="reference internal" href="#markup-doc-parts" id="id17">Markup doc parts</a></li>
<li><a class="reference internal" href="#required-cascading-style-sheets" id="id18">Required cascading style sheets</a></li>
</ul>
</li>
<li><a class="reference internal" href="#further-study" id="id19">Further study</a></li>
<li><a class="reference internal" href="#acknowledgements" id="id20">Acknowledgements</a></li>
<li><a class="reference internal" href="#theory-of-operation" id="id21">Theory of operation</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="tutorial">
<h2><a class="toc-backref" href="#id2">Tutorial</a><a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial tells how to get started with Leo&#8217;s rst3 command. The tutorial
covers only rst3&#8217;s basic features. You can do a <em>lot</em> with these features&#8211;Leo&#8217;s
documentation uses only the features described here!</p>
<p>Step-by-step, here is how to use the rst3 command:</p>
<ol class="arabic simple">
<li>Create an &#64;rst node. This node and its descendants will contain your
document. The &#64;rst node itself is a good place to specify general
information about your documentation, including its title, one or more
external files created by the rst3 command, and global settings for the rst3
command.</li>
<li>Write your documentation in the descendants of the &#64;rst node. Within the
&#64;rst tree, <strong>headlines represent section headings</strong>. Body text contain your
writing, including rST or Sphinx markup.</li>
<li>To create your documents, run the rst3 command on an outline containing one
or more &#64;rst nodes.</li>
</ol>
<p>That&#8217;s all there is to it! The organization of the &#64;rst tree <em>is</em> the organization
of your document. To reorganize your document, you just reorganize the nodes in
the &#64;rst tree!  When you are done writing, create your output using the rst3 command.</p>
<p>The next sections will discuss these three steps in more detail. As you will
see, after you set up the &#64;rst node, you can focus exclusively on writing and
organizing. Leo&#8217;s rst3 command will take care of the rest.</p>
<div class="section" id="step-1-create-the-rst-node">
<h3><a class="toc-backref" href="#id3">Step 1: Create the &#64;rst node</a><a class="headerlink" href="#step-1-create-the-rst-node" title="Permalink to this headline">¶</a></h3>
<p>The headline of the &#64;rst node has the form:</p>
<div class="highlight-python"><pre>@rst &lt;filename&gt;</pre>
</div>
<p>Depending on options to be discussed later, the rst3 command will write one or two files:
the <strong>output file</strong> (&lt;filename&gt;), and the <strong>intermediate file</strong> (&lt;filename&gt;.txt).</p>
<p>For example, the rst3 command applied to &#64;rst abc.html will write
abc.html or abc.html.txt or both.</p>
<p><strong>Important</strong>: The intermediate file <em>always</em> contains rST/Sphinx markup
<em>regardless</em> of the type of the final output files. When in doubt about the rst3
command, you can examine the intermediate file to see what rst3 has done.</p>
<p>Let&#8217;s turn our attention to the the body of the &#64;rst node...</p>
<div class="section" id="set-global-options">
<h4><a class="toc-backref" href="#id4">Set global options</a><a class="headerlink" href="#set-global-options" title="Permalink to this headline">¶</a></h4>
<p>The &#64;rst node is a good place for options that apply to the entire &#64;rst
tree. Typically, you will just set these options once and then completely forget
about them.</p>
<p>You set rst3 options in body parts like this:</p>
<div class="highlight-python"><pre>@ @rst-options
rst3 options, one per line
@c</pre>
</div>
<p>This is a Leo doc part: the &#8216;&#64;&#8217; must appear in the leftmost column. As usual,
the doc part ends with the &#64;c directive, or the end of the body text.</p>
<p>Here are the recommended options when using docutils:</p>
<div class="highlight-python"><pre>@ @rst-options
call_docutils=True
code_mode=False
stylesheet_path=..\doc
write_intermediate_file=True
@c</pre>
</div>
<p>And here are the recommended options when using Sphinx:</p>
<div class="highlight-python"><pre>@ @rst-options
call_docutils=False
code_mode=False
stylesheet_path=..\doc
write_intermediate_file=True
@c</pre>
</div>
<p><strong>Note 1</strong>: It is good style to specify all these options explicitly, even if they are
the same as the standard default values. This ensures that the rst3 command
will produce the same results no matter where the &#64;rst node is located.</p>
<p><strong>Note 2</strong>: You may have to change the stylesheet_path option so that the
generated output file can find the proper stylesheets.</p>
</div>
<div class="section" id="set-your-document-s-title">
<h4><a class="toc-backref" href="#id5">Set your document&#8217;s title</a><a class="headerlink" href="#set-your-document-s-title" title="Permalink to this headline">¶</a></h4>
<p>Next, set your document&#8217;s title by putting something like this in the
body text of the &#64;rst node:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#############</span>
<span class="n">War</span> <span class="ow">and</span> <span class="n">Peace</span>
<span class="c">#############</span>
</pre></div>
</div>
<p><strong>Important</strong>: The rst3 command reserves the &#8216;#&#8217; character for the document
titles&#8211;don&#8217;t use any other underlining character.</p>
<p>Sometimes I put the first words of a document in the &#64;rst node:</p>
<div class="highlight-python"><pre>Well, Prince, so Genoa and Lucca are now just family estates of the
Buonapartes. But I warn you, if you don't tell me that this means war, if
you still try to defend the infamies and horrors perpetrated by that
Antichrist--I really believe he is Antichrist--I will have nothing more to
do with you and you are no longer my friend, no longer my 'faithful slave,'
as you call yourself! But how do you do? I see I have frightened you--sit
down and tell me all the news.</pre>
</div>
</div>
</div>
<div class="section" id="step-2-write-your-document">
<h3><a class="toc-backref" href="#id6">Step 2: Write your document</a><a class="headerlink" href="#step-2-write-your-document" title="Permalink to this headline">¶</a></h3>
<p>Now comes the &#8220;interesting&#8221; part&#8211;actually writing your novel, short story,
documentation or whatever.</p>
<p>As always with Leo, you organize your work with outlines. By default, (that is,
with the recommended options discussed in Step 1) the rst3 command will produce
the following output:</p>
<ol class="arabic">
<li><p class="first">Each node becomes an rST/Sphinx section.</p>
<p>The level of each section corresponds to the level of the node in the
headline. Children of the &#64;rst node create level 1 sections. Grandchildren of
the &#64;rst node create level 2 sections, and so on.</p>
</li>
<li><p class="first">The headline of each node becomes the section heading.</p>
</li>
<li><p class="first">The body text of each node becomes the contents of the node&#8217;s section.</p>
<p><strong>Note</strong>: The body text of any node in an &#64;rst tree contains plain text,
with optional rST or Sphinx markup. Sphinx markup is a superset of rST
markup. For more details on markup, see the <a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a> or <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a>
documentation.</p>
</li>
</ol>
<p>That&#8217;s all there is to it!</p>
<p>Well almost. There is one other feature you should know about. Headlines that
start with &#8216;&#64;rst-&#8216; control the rst3 command.  The three most useful are:</p>
<dl class="glossary docutils">
</dl>
<p>&#64;rst-no-head &lt;ignored-text&gt;</p>
<blockquote>
Causes the rst3 command to copy just the body text of the node. In other
words, the node&#8217;s body text become part of the previous section. Leo&#8217;s docs
use such nodes for rST links and other &#8220;invisible&#8221; markup.</blockquote>
<p>&#64;rst-ignore &lt;ignored-text&gt;</p>
<blockquote>
The rst3 command ignores any &#64;rst-ignore node. Neither the headline nor the
body text becomes part of the output. You can use such nodes for notes that
you do not want to become part of the actual document.</blockquote>
<p>&#64;rst-ignore-tree &lt;ignored-text&gt;</p>
<blockquote>
The rst3 command ignores the &#64;rst-ignore-tree node and all its descendants.</blockquote>
</div>
<div class="section" id="step-3-run-the-rst3-command">
<h3><a class="toc-backref" href="#id7">Step 3: Run the rst3 command</a><a class="headerlink" href="#step-3-run-the-rst3-command" title="Permalink to this headline">¶</a></h3>
<p>This step is easy. Select an outline containing one or more &#64;rst trees. Now do
&lt;Alt-X&gt;rst3&lt;Return&gt;. You can use &lt;Ctrl-P&gt; (repeat-complex-command) instead if
the last minibuffer command was the rst3 command.</p>
<p>The rst3 command writes its output to either the output file or the intermediate
file, or both:</p>
<ul class="simple">
<li>With the recommended settings for docutils, the rst3 command will run docutils
automatically, producing the output file as the result.</li>
<li>With the recommended settings for Sphinx, the rst3 command will generate the
intermediate file. You must then run Sphinx&#8217;s make utility to turn the
intermediate file into the final output file.</li>
</ul>
</div>
<div class="section" id="go-forth-and-experiment">
<h3><a class="toc-backref" href="#id8">Go forth and experiment</a><a class="headerlink" href="#go-forth-and-experiment" title="Permalink to this headline">¶</a></h3>
<p>You now know everything needed to get started with the rst3 command.
Some possible next steps are:</p>
<ol class="arabic simple">
<li>Look at Leo&#8217;s own documentation in LeoDocs.leo. It&#8217;s in the node &#8220;&#64;rst
htmlrstplugin3.html&#8221;. Discover how the nodes in this tree correspond to the
documentation you see before you.</li>
<li>Create your own &#64;rst nodes. Run the rst3 command on them and see what
happens. If you get stuck, you please ask for help at
<a class="reference external" href="http://groups.google.com/group/leo-editor">Leo&#8217;s Google Group</a>.</li>
</ol>
</div>
</div>
<div class="section" id="options">
<h2><a class="toc-backref" href="#id9">Options</a><a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p>This section discusses options&#8211;what they are, how to set them and how to set their defaults.</p>
<div class="section" id="general-options">
<h3><a class="toc-backref" href="#id10">General options</a><a class="headerlink" href="#general-options" title="Permalink to this headline">¶</a></h3>
<p>Here is a complete list of options for the rst3 and code-to-rst commands:</p>
<dl class="glossary docutils">
</dl>
<p>call_docutils (default: True):</p>
<blockquote>
Call docutils to process the intermediate file.</blockquote>
<p>default_path (default: &#8216;&#8217;)</p>
<blockquote>
The path to be prepended to filenames given in root nodes.</blockquote>
<p>default_encoding (default: utf-8)</p>
<blockquote>
The default encoding to be used for non-ascii (unicode characters).</blockquote>
<p>encoding (default: the default_encoding setting)</p>
<blockquote>
The encoding to be used for non-ascii (unicode) characters.
<strong>Important</strong>: this option has effect only in &#64;rst-options doc parts
in root &#64;rst nodes.</blockquote>
<p>generate_rst (default: True)</p>
<blockquote>
A master switch.
True: generate rST markup for rST sections and rST code-blocks.
False: generate plain text and ignore &#64; &#64;rst-markup doc parts.</blockquote>
<p>generate_rst_header_comment (default: True)</p>
<blockquote>
<p>True: Leo writes a comment line of the form:</p>
<div class="highlight-python"><pre>.. rst3: filename: &lt;filename&gt;</pre>
</div>
<p>at the start of intermediate files. This option has effect only if the
generate_rst and write_intermediate_file options are both True.</p>
</blockquote>
<p>publish-argv-for-missing-stylesheets (Default: &#8216;&#8217;)</p>
<blockquote>
<p>The arguments to be passed to docutils.core.Publisher().publish() when no
stylesheet is in effect. This is a string that represents a comma-separated
list of strings: For example, the option:</p>
<div class="highlight-python"><pre>publish-argv-for-missing-stylesheets=--language=de,--documentclass=report,--use-latex-toc</pre>
</div>
<p>results in the call:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">publish</span><span class="p">([</span><span class="s">&#39;--language=de&#39;</span><span class="p">,</span><span class="s">&#39;--documentclass=report&#39;</span><span class="p">,</span><span class="s">&#39;--use-latex-toc&#39;</span><span class="p">])</span>
</pre></div>
</div>
</blockquote>
<p>show_headlines (default: True)</p>
<blockquote>
<p>True: automatically generate rST sections from headlines.
False: ignore headlines.</p>
<p><strong>Note</strong>: The level of the node in the outline determines the level of the
section underlining in the rST markup. Higher-level headlines in the outline
correspond to higher-level section headings; lower-level headlines in the
outline correspond to lower-level section headings.</p>
</blockquote>
<p>show_organizer_nodes (default: True)</p>
<blockquote>
<p>True: generate rST sections for nodes that do not contain body text.</p>
<p><strong>Note</strong>: This option has no effect unless the rST section would otherwise be written.</p>
</blockquote>
<p>show_sections (default: True)</p>
<blockquote>
<p>True: generate rST sections corresponding to headlines.
False: don&#8217;t generate sections.  Instead, generate lines of the form:</p>
<div class="highlight-python"><pre>**headline**</pre>
</div>
</blockquote>
<p>strip_at_file_prefixes (default: True)</p>
<blockquote>
True: remove &#64;auto, &#64;file, &#64;nosent and &#64;thin from the start of headlines.</blockquote>
<p>stylesheet_name (default: &#8216;default.css&#8217;)</p>
<blockquote>
The name of the stylesheet passed to docutils.</blockquote>
<p>stylesheet_path (default: &#8216;&#8217;)</p>
<blockquote>
<p>The directory containing the stylesheet passed to docutils.</p>
<p><strong>Note</strong>: If the stylesheet_embed option is True, specify a path relative to
the location of the Leo file. If the stylesheet_embed option is False,
specify a path relative to the location of the HTML file.</p>
</blockquote>
<p>stylesheet_embed (default: True)</p>
<blockquote>
True: The content of the stylesheet file will be embedded in the HTML file.
False: The HTML file will link to an external stylesheet file.</blockquote>
<p>underline_characters (default: #=+*^~&#8221;&#8217;`-:&gt;_)</p>
<blockquote>
The underlining characters to be used to specify rST sections.
The first character is reserved so you can specify the top-level section explicitly.</blockquote>
<p>verbose (default: True)</p>
<blockquote>
True: write informational messages.</blockquote>
<p>write_intermediate_file (default: False)</p>
<blockquote>
<p><strong>Important</strong>: the rst3 command <em>always</em> creates an intermediate file.
This option controls whether that file is an internal Python object
or an actual file on the external file system.</p>
<p>True: writes the intermediate file to the external file system. The name of
the intermediate file has the name of the output file with .txt appended.
This option has effect only if the generate_rst option is True.</p>
<p>False: writes the intermediate file to an internal Python object.</p>
</blockquote>
</div>
<div class="section" id="headline-commands">
<h3><a class="toc-backref" href="#id11">Headline commands</a><a class="headerlink" href="#headline-commands" title="Permalink to this headline">¶</a></h3>
<p>Any headline that starts with &#64;rst- controls the rst3 command.</p>
<dl class="glossary docutils">
</dl>
<p>&#64;rst-ignore &lt;ignored-text&gt;</p>
<blockquote>
Ignore the node and its descendants.</blockquote>
<p>&#64;rst-ignore-node &lt;ignored-text&gt;</p>
<blockquote>
Ignore the node, but <em>not</em> its descendants.</blockquote>
<p>&#64;rst-ignore-tree &lt;ignored-text&gt;</p>
<blockquote>
Same as &#64;rst-ignore.  Ignore the node and its descendants.</blockquote>
<p>&#64;rst-no-head &lt;ignored-text&gt;</p>
<blockquote>
Ignore the headline but not the body text of this node.
This has no effect on descendant nodes.</blockquote>
<p>&#64;rst-no-headlines &lt;ignored-text&gt;</p>
<blockquote>
Ignore all headlines. (Set show_headlines=False)</blockquote>
<p>&#64;rst-option &lt;option&gt; = &lt;value&gt;</p>
<blockquote>
Set a single option to the given value. The default value is True.</blockquote>
<p>&#64;rst-options &lt;ignored-text&gt;</p>
<blockquote>
<p>Set options from body text. The body text should contain nothing but
lines of the form:</p>
<div class="highlight-python"><pre>&lt;option&gt;=&lt;value&gt;</pre>
</div>
</blockquote>
<p>&#64;rst-preformat &lt;ignored-text&gt;</p>
<blockquote>
<p>Format the body text of the node as computer source code. In effect, this
option adds a line containing &#8216;::&#8217; at the start of the body text. The option
then indents all following lines.</p>
<p>This option has no effect on descendant nodes.</p>
</blockquote>
</div>
<div class="section" id="option-doc-parts">
<h3><a class="toc-backref" href="#id12">Option doc parts</a><a class="headerlink" href="#option-doc-parts" title="Permalink to this headline">¶</a></h3>
<p><strong>Option doc parts</strong> set rst3 options. Option doc parts start with &#64;
&#64;rst-options followed by lines of the form name=value. (Comment lines starting
with &#8216;..&#8217; are allowed.) For example:</p>
<div class="highlight-python"><pre>@ @rst-options
.. This comment line is ignored.
show_headlines=False
show_leo_directives=False
verbose=True
@c</pre>
</div>
<p>This is a real Leo doc part. Like all other doc parts an option doc part starts
with the &#64; directive and continues until the end of body text or until the next
&#64;c directive.</p>
</div>
<div class="section" id="defaults-for-options">
<h3><a class="toc-backref" href="#id13">Defaults for options</a><a class="headerlink" href="#defaults-for-options" title="Permalink to this headline">¶</a></h3>
<p>Settings in leoSettings.leo or myLeoSettings.leo specify the defaults
to be used for all rst3 options.  The form of these settings is:</p>
<div class="highlight-python"><pre>@bool rst3_&lt;option name&gt; = True/False
@string rst3_&lt;option name&gt; = aString</pre>
</div>
<p>That is, to create a default value for an rst3 setting, you must
prefix the option name with &#8216;rst3_&#8217;.  For example:</p>
<div class="highlight-python"><pre>@bool rst3_write_intermediate_file = True</pre>
</div>
</div>
<div class="section" id="http-plugin-options">
<h3><a class="toc-backref" href="#id14">Http plugin options</a><a class="headerlink" href="#http-plugin-options" title="Permalink to this headline">¶</a></h3>
<p>The following options are for the use of Bernhard Mulder&#8217;s http plugin. The http
plugin creates an http server running on a local port, typically 8080. When the
http plugin is running you will see a purple message in the log window that
looks something like this:</p>
<div class="highlight-python"><pre>http serving enabled on port 8080, version 0.91</pre>
</div>
<p>To use the http plugin, start a web browser and enter this url:</p>
<div class="highlight-python"><pre>http://localhost:8080/</pre>
</div>
<p>You will see a a top level page containing one link for every open .leo file.
Clicking on a link will cause the http server to pass a new page to the browser.
You can use the browser&#8217;s refresh button to update the top-level view in the
browser after you have opened or closed files.</p>
<p><strong>Important</strong>: See the docstring for the http plugin for information on
configuring the plugin. Some of the following rst3 settings must match values of
settings for the http plugin.</p>
<p>Here are the rst3 options that support the http plugin:</p>
<dl class="glossary docutils">
</dl>
<p>http_server_support (default: False)</p>
<blockquote>
<p>A master switch: none of the following options have any effect unless this
option is True. If True, the rst3 command does the following:</p>
<ol class="arabic">
<li><p class="first">Writes <strong>node markers</strong> in the rst output for use by the http plugin.
Node markers are rst named hyperlink targets. By default they look like:</p>
<div class="highlight-python"><pre>.. _http-node-marker-N</pre>
</div>
<p>where N is a unique node number.</p>
</li>
<li><p class="first">Adds additional information to all nodes of the tree being formatted using
Leo&#8217;s unknownAttributes mechanism.</p>
</li>
</ol>
</blockquote>
<p>http_attributename (default: &#8216;rst_http_attribute&#8217;)</p>
<blockquote>
<p>The name of the attribute name written to the unknownAttributes attribute of
each outline node in the rst root tree. The default is
&#8216;rst_http_attribute&#8217;; it should match the following setting of the http
plugin:</p>
<div class="highlight-python"><pre>@string rst_http_attributename = 'rst_http_attribute'</pre>
</div>
</blockquote>
<p>clear_http_attributes (default: False)</p>
<blockquote>
If True the rst3 command initially clears the fields specified by <cite>http_attributename</cite>.</blockquote>
<p>node_begin_marker (default: &#8216;http-node-marker-&#8216;)</p>
<blockquote>
The string used for node markers.</blockquote>
</div>
<div class="section" id="section-expansion-options">
<h3><a class="toc-backref" href="#id15">Section expansion options</a><a class="headerlink" href="#section-expansion-options" title="Permalink to this headline">¶</a></h3>
<p><strong>New in Leo 4.9</strong>: The following three options allow you
to expand noweb section references, much like Leo itself does.</p>
<p><strong>expand_noweb_references</strong></p>
<blockquote>
True: Replace references by definitions.
Definitions must be descendants of the referencing node.</blockquote>
<p><strong>ignore_noweb_definitions</strong></p>
<blockquote>
True: ignore section definition nodes.</blockquote>
<p><strong>expand_noweb_recursively</strong></p>
<blockquote>
True: recursively expand definitions by expanding any
references found in definitions.</blockquote>
<p>Notes:</p>
<ul class="simple">
<li>This is an experimental feature: all aspects might changed. The defaults for
all these options ensure that the rst3 command works as it has always.</li>
<li>The rst3 command ensures that unbounded expansions can not happen. While
expanding any section, the rst3 will not expand again any sections that have
already occurred in the expansion.</li>
</ul>
</div>
</div>
<div class="section" id="other-topics">
<h2><a class="toc-backref" href="#id16">Other topics</a><a class="headerlink" href="#other-topics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="markup-doc-parts">
<h3><a class="toc-backref" href="#id17">Markup doc parts</a><a class="headerlink" href="#markup-doc-parts" title="Permalink to this headline">¶</a></h3>
<p><strong>Markup doc parts</strong> have the following form:</p>
<div class="highlight-python"><pre>@ @rst-markup
any rST markup
@c</pre>
</div>
<p>Markup doc parts inserts the markup directly into the output. Markup doc parts
are most useful when formatting an outline as code using the code-to-rst
command.</p>
</div>
<div class="section" id="required-cascading-style-sheets">
<h3><a class="toc-backref" href="#id18">Required cascading style sheets</a><a class="headerlink" href="#required-cascading-style-sheets" title="Permalink to this headline">¶</a></h3>
<p>HTML files generated by the rst3 command assume that three .css (cascading style
sheet) files exist in the same directory. For the HTML output to look good the
following .css files should exist:</p>
<ul class="simple">
<li>default.css is the default style sheet that docutils expects to exist.</li>
<li>leo_rst.css contains some style improvements based on Gunnar Schwant&#8217;s DocFactory.</li>
<li>silver_city.css is the style sheet that controls the syntax highlighting generated by SilverCity.</li>
</ul>
<p>The latter two style sheets are imported at the end of the default.css.</p>
<p><strong>Important:</strong> You can use cascading style sheets to do things that otherwise
wouldn&#8217;t be possible with &#8220;plain&#8221; rST. For instance, the background color of
this page was specified in a body style.</p>
</div>
</div>
<div class="section" id="further-study">
<h2><a class="toc-backref" href="#id19">Further study</a><a class="headerlink" href="#further-study" title="Permalink to this headline">¶</a></h2>
<p>The file <a class="reference external" href="http://webpages.charter.net/edreamleo/ListManagerDocs.html">ListManagerDocs.html</a> is an impressive example of the kind of output
that can be generated relatively easily using the rst3 command.</p>
<p>The source for ListManagerDocs.html is <a class="reference external" href="http://webpages.charter.net/edreamleo/wxListManager.leo">wxListManager.leo</a>. <strong>Important</strong>:
wxListManager.leo was written for the old rst2 plugin; it could be greatly
simplified if adapted for the rst3 command.</p>
<p>This documentation was created using the rst3 command. The source code for this
documentation is in LeoDocs.leo. The source code for the rst3 command is in
leoRst.py in leoPy.leo.</p>
</div>
<div class="section" id="acknowledgements">
<h2><a class="toc-backref" href="#id20">Acknowledgements</a><a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Josef Dalcolmo wrote the initial rst plugin.
Timo Honkasalo, Bernhard Mulder, Paul Paterson, Kent Tenney and
Steve Zatz made contributions to the rst and rst2 plugins.</p>
</div>
<div class="section" id="theory-of-operation">
<h2><a class="toc-backref" href="#id21">Theory of operation</a><a class="headerlink" href="#theory-of-operation" title="Permalink to this headline">¶</a></h2>
<p>The code for the rst3 command is more complex than usual. Fortunately, the
overall organization is straightforward.</p>
<dl class="docutils">
<dt>defaultOptionsDict</dt>
<dd>This dictionary represents each rst3 option.
To add another option, just add another entry to this dictionary.
Keys are the option name, including the <cite>rst3_</cite> prefix.
Values are the default value of the option.
The hard-coded values in the dictionary may be changed as the result of &#64;settings entries.</dd>
<dt>processTree</dt>
<dd>processTree is the top-level code that handles one rst root node.
It calls preprocessTree to create the <strong>vnodeOptionDict</strong> ivar.
processTree then calls either writeNormalTree or writeSpecialTree
depending on whether text will be sent to docutils for further processing.
These two methods handle mundane details of opening and closing files.
Both writeNormalTree and writeSpecialTree call <strong>writeTree</strong> to do the actual work.</dd>
<dt>vnodeOptionDict</dt>
<dd>The entries in this dictionary represent the options that are set in one particular node.
The keys of vnodeOptionDict are vnodes, the values are anonymous dictionaries.
These anonymous inner dictionaries contain the options that are explicitly set at each vnode
(and thus each position).
Preprocessing the tree this way ensures that each node (headline and body text) is parsed exactly once.</dd>
<dt>writeTree</dt>
<dd>writeTree first calls <strong>scanAllOptions</strong>, which has the effect of
initializing all options. writeTree then calls <strong>writeNode</strong> for each node
that will be processed by the rst3 command. Options may cause the rst3 command to
skip a node or an entire subtree.</dd>
<dt>writeNode</dt>
<dd>writeNode first calls <strong>scanAllOptions</strong> to compute the options that are in
effect for that <em>single</em> node. Once options have been computed, processing the
node is straightforward. writeNode calls writeBody and writeHeadline
to do the real work. These methods generate or skip text based on various
options.</dd>
<dt>scanAllOptions</dt>
<dd><p class="first">scanAllOptions recreates the optionsDict ivar to represent <em>all</em> the options
in effect for <em>for the particular node being processed by writeNode</em>. Client
code gets these options by calling the getOption method.</p>
<p class="last">scanAllOptions first inits all options from settings,
then updates those options using the anonymous
dictionaries contained in the vnodeOptionsDict.
scanAllOptions works like g.scanAllDirectives, but the code is much simpler.</p>
</dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="leo_toc.html">
              <img class="logo" src="_static/Leo4-80-border.jpg" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="coloring.html"
                        title="previous chapter">Controlling Syntax Coloring</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scripting.html"
                        title="next chapter">Scripting Leo with Python</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="scripting.html" title="Scripting Leo with Python"
             >next</a> |</li>
        <li class="right" >
          <a href="coloring.html" title="Controlling Syntax Coloring"
             >previous</a> |</li>
        <li><a href="leo_toc.html">Leo v4.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Edward K. Ream.
      Last updated on Oct 31, 2011.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>